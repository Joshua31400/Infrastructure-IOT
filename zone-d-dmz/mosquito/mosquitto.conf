# ===== CONFIGURATION MOSQUITTO AVEC mTLS =====

# Port MQTTS (MQTT over TLS)
listener 8883
protocol mqtt

# Certificats TLS
cafile /mosquitto/config/certs/ca.crt
certfile /mosquitto/config/certs/server.crt
keyfile /mosquitto/config/certs/server.key

# Exiger authentification par certificat client
require_certificate true
use_identity_as_username true

# TLS version minimale (sécurité)
tls_version tlsv1.2

# Persistence des messages
persistence true
persistence_location /mosquitto/data/

# Logs détaillés
log_dest file /mosquitto/log/mosquitto.log
log_type all

# ACL (Access Control List)
acl_file /mosquitto/config/acl.conf

# Pas d'anonymous (sécurité)
allow_anonymous false